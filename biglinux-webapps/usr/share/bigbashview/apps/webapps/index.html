    <!-- Name of JSON file with translation -->
    <script>const projectName = 'bigcontrolcenter';</script>

    <!-- Include the generic header (CSS and JS) -->
    <?include html /usr/share/bigbashview/framework/html/genericHeader.html?>

    <!-- Include window control side decorator -->
    <link href="/usr/share/bigbashview/framework/css/client-side-decorator.css" rel="stylesheet">
    <script src="qrc:///qtwebchannel/qwebchannel.js"></script>
    <script src="/usr/share/bigbashview/framework/js/client-side-decorator.js" defer></script>

    <!-- Includes the window control side shell script -->
    <?include bash /usr/share/bigbashview/framework/shell/windowControlSide.sh 2> /dev/null ?>

    <style>
      .description-container {
        position: fixed;
        bottom: 0;
        width: 100%;
        text-align: center;
        padding: 10px;
        background-color: rgba(0, 0, 0, 0.8);
        color: white;
        border-radius: 7px;
        margin-bottom: 24px;
        margin-right: 28px;
      }
    </style>
</head>
<body x-data="appData()" x-init="fetchData()" @keydown.window="handleGlobalKeypress($event)">
  <!-- Using Client Side Decoration use body transparent to make shadow, and page work like real body -->
  <div id="page">
    <!-- Any component with drag-area class is used to drag and move window -->
    <div id="title-bar" class="drag-area">
      <div id="app-left-title" class="row absolute left drag-area page-content">
      <img class="circle mini drag-area" src="/usr/share/icons/hicolor/scalable/apps/webapps.svg">
      <h6 class="small drag-area" stonejs>WebApps</h6>
      </div>
      <div class="field prefix round input-search-center">
        <i>search</i>
        <!-- Using placeholderText to modify in javascript for translated text in stonejs -->
        <input type="search" x-model="filterText" @input="filterPrograms()" :placeholder="placeholderText" id="searchInput">
      </div>
    </div>

    <!-- Info about connecting from Android Device -->
    <dialog class="dialog min-width-60em no-padding no-margin" id="dialog-android-usb">
      <h6 class="surface-bgcolor no-round large-padding center-align drag-area" small stonejs>Using Your Android Device's Internet on Linux via USB</h6>
      <div class="large medium-padding medium-margin medium-line left-align">
        <p stonejs>To share your Android smartphone's internet connection with a Linux computer using a USB cable, follow these steps:</p>
        <ul>
          <li stonejs>Connect your Android smartphone to the Linux computer using a USB cable.</li>
          <li stonejs>On your smartphone, open 'Settings' and navigate to 'Network & Internet' or 'Connections & Sharing'.</li>
          <li stonejs>Look for 'USB Tethering', 'USB Tether', or similar terms and enable it.</li>
        </ul>
        <p stonejs>This will automatically establish the internet connection on your Linux computer without requiring any additional configuration.</p>
        <img class="tiny" src="warning.svg"><span stonejs>If your Android device is not connected to Wi-Fi and is using cellular data, this tethering will consume data from your cellular plan. To avoid data charges, ensure that your Android device is connected to a Wi-Fi network before enabling tethering.</span></p>
        <nav class="right-align">
          <button data-ui="#dialog-android-usb" stonejs>Close</button>
        </nav>
      </div>
    </dialog>

    <!-- showing content -->
    <div id="main" class="drag-area page-content-without-left-bar system-background-color">
          <template x-for="program in filteredPrograms" :key="program.app_file">
            <button @click="_run(program.app_file);ui(program.app_file)"
              @mouseenter="showDescription(program.app_url)" @mouseleave="clearDescription()"
              class="vertical border no-border space-between box-items">
              <img :src="program.app_icon_url" class="responsive icon-medium no-round" />
              <span x-text="program.app_name" class="min-height-fill"></span>
            </button>
          </template>
      </div>
    </div>
</body>

<script>
  function appData() {
    return {
      programs: [],
      filteredPrograms: [],
      filterText: "",
      descriptionToShow: "",
      placeholderText: "",

      fetchData() {
        fetch("get_json.sh")
          .then(response => response.json())
          .then(data => {
            this.programs = data;
            this.filteredPrograms = data; // Initialize filteredPrograms with all programs
          });
        this.placeholderText = _('Search...');
      },

      handleGlobalKeypress(event) {
        // Check if the active element is not an input field
        if (!['INPUT', 'TEXTAREA', 'SELECT'].includes(document.activeElement.tagName)) {
          if (event.key === 'Backspace' && this.filterText.length > 0) {
            this.filterText = this.filterText.slice(0, -1); // Remove the last character
            this.filterPrograms(); // Update filtered programs
          } else if (event.key.length === 1) {
            this.filterText += event.key; // Adds the pressed character to the filter text
            this.filterPrograms(); // Filters programs according to the text
          }
          // Focus on the input field after modifying the text
          this.$nextTick(() => {
            this.$refs.searchInput.focus();
          });
        }
      },

      filterPrograms() {
        if (this.filterText === "") {
          // If the filter text is empty, show all programs
          this.filteredPrograms = this.programs;
        } else {
          // Otherwise, filter based on the text
          this.filteredPrograms = this.programs.filter(program => {
            const name = this.normalizeText(program.app_name);
            const description = this.normalizeText(program.app_url);
            const id = this.normalizeText(program.app_file);
            return name.includes(this.normalizeText(this.filterText)) ||
              description.includes(this.normalizeText(this.filterText)) ||
              id.includes(this.normalizeText(this.filterText));
          });
        }
        // Alphabetical sorting
        this.filteredPrograms.sort((a, b) => a.app_name.localeCompare(b.app_name));
      },

      showDescription(description) {
        if (description) this.descriptionToShow = description;
      },

      clearDescription() {
        this.descriptionToShow = "";
      },

      normalizeText(text) {
        if (typeof text !== 'string') return ""; // Handle non-string inputs safely
        return text.normalize("NFD").replace(/[\u0300-\u036f]/g, "").toLowerCase();
      }
    };
  }
</script>
</html>